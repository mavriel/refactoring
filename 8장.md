# 8. 기능이동

## 8.1 함수 옮기기 (Move Function)

### 언제/의견/주의사항

- 특정 클래스의 요소들을 더 많이 참조하는 함수를 이동
- 자기의 느낌대로 옮겨보고, 이상하다면 나중에 다시 다른 곳으로 옮기면 된다.

### 절차

1. 선택한 함수가 사용하는 요소중 같이 옮길것들 고민
   - 같이 옮길것이 함수면 그것을 먼저 이동
   - 얽힌 함수가 여러 개라면, 다른 곳에 미치는 영향이 가장 작은 함수부터 이동
   - 하위 함수의 호출자가 하나라면, 인라인 후 이동 후 함수 추출
2. 선택한 함수가 다형 메서드인지 확인
   - 슈퍼클래스, 서브클래서에서 쓰이는지 확인 필요
3. 선택한 함수를 타겟 컨텍스트로 복사
4. 정적 분석
5. 소스 컨택스트에서 타겟 함수를 참조할 방법을 반영
6. 소수 함수를 타겟 함수의 위임 함수로 변경
7. 테스트
8. 소스 함수를 인라인할지 고려

## 8.2 필드 옮기기 (Move Field)

### 언제/의견/주의사항

- 아무리 설계를 잘 해도, 프로젝트를 진행하다보면 올바른 설계가 잘못된 것이 되곤한다.
- 데이터 구조가 적절하지 않다면 바로 수정한다.
- 한 레코드를 변경하려 할 때 다른 레코드의 필드를 변경해야 하면, 필드의 위치가 잘못되었다는 것

### 절차

1. 소스 필드가 캡슐화되지 않았다면 캡슐화
2. 테스트
3. 타겟 객체에 필드 생성
4. 정적 검사
5. 소스 객체에서 타겟 객체 참조 여부 확인
6. 타겟 필드 사용하게 변경
7. 테스트
8. 소스필드 제거
9. 테스트

## 8.3 문장을 함수 옮기기 (Move Statements into Function)

### 언제/의견/주의사항

- 문장들이 피호출함수의 일부인 경우

### 절차

1. 반복코드가 함수 호출부분과 멀리 떨어져 있다면, 문장 슬라이드로 근처로 이동
2. 타겟함수가 하나라면 단순히 복사후 테스트하고 마무리
3. 타겟함수가 여러개면 기억하기 쉬운 임시 이름으로 함수 추출
4. 타겟함수에서 추출한 함수 사용하도록 변경. 각각 테스트
5. 모두 새로운 함수를 사용하면, 원래 함수를 새로운 함수 안으로 인라인, 원래 함수 제거
6. 함수면 변경

## 8.4 문장을 호출한 곳으로 옮기기 (Move Statements to Callers)

### 언제/의견/주의사항

- 응집도가 높고 한가지 일만 하던 함수가 둘이상의 다른일을 수행하게 된 경우

### 절차

1. 호출자가 한 두개뿐이고 피호출 함수도 간단하면, 피호출함수를 일부를 잘라내어 호출자로 복사. 테스트 통과하면 완료
2. 더 복잡한 상황에서는 이동하지 않을 문장을 임시 이름으로 함수로 추출
   - 대상 함수가 서브클래스에서 오버라이드돼었다면, 서브클래스에서 동일하게 남길 부분을 메서드로 추출. 남겨진 메서드의 본문은 모든 클래스에서 동일. 슈퍼클래스의 메서드만 놔두고 서브클래스의 메서드 제거
3. 원래 함수 인라인
4. 이름 변경

## 8.5 인라인 코드를 함수 호출로 바꾸기 (Replace Inline Code with Function Call)

### 언제/의견/주의사항

### 절차

## 8.6 문장 슬라이드하기 (Slide Statements)

### 언제/의견/주의사항

### 절차

## 8.7 반복문 쪼개기 (Split Loop)

### 언제/의견/주의사항

### 절차

## 8.8 반복문을 파이프라인으로 바꾸기 (Replace Loop with Pipeline)

### 언제/의견/주의사항

### 절차

## 8.9 죽은 코드 제거하기 (Remove Dead Code)

### 언제/의견/주의사항

### 절차
